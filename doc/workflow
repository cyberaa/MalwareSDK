
ANTI-HEURISTIC      ROOTKIT
            \       /
             \     /
               CORE --- CONFIG
             /     \
            /       \
           OS      NETWORK
                      /\
                     /  \
                   API  TCP STACK

CORE:
  The brains.
NETWORK:
  Handles all communication from CORE to C&C.
  API:
    Formats messages, creates packets to send to TCP STACK
  TCP STACK:
    Performs abstract communication to/from C&C.
OS:
  Handles communication between CORE and the host operating system.
ROOTKIT:
  Regardless of ring, rootkit hides the malware from the host OS.
ANTI-HEURISTIC:
  Protects the application from antivirus software and anti-malware.
CONFIG:
  Configures the malware at compile time for target platform, networking stack, etc.

